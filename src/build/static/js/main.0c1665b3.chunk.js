(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{181:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(85),i=n.n(o);n(93),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=n(183),s=n(179),c=n(3),u=n(4),m=n(6),d=n(5),h=n(7),p=n(182),f=n(180),E=n(54),b=n.n(E),g=r.a.createContext(null),v=r.a.createContext(null),S=function(e){return function(t){return r.a.createElement(v.Consumer,null,function(n){return r.a.createElement(e,Object.assign({},t,{firebase:n}))})}},O=v,C=n(8),j=n(24),k=n.n(j),y=(n(169),n(171),{apiKey:"AIzaSyDhMZ6QU4BID6sEiSlOtMck0QLJaNuzAg8",authDomain:"halflajf-9d586.firebaseapp.com",databaseURL:"https://halflajf-9d586.firebaseio.com",projectId:"halflajf-9d586",storageBucket:"halflajf-9d586.appspot.com",messagingSenderId:"623585970782"}),w=function e(){var t=this;Object(c.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,n){return t.auth.createUserWithEmailAndPassword(e,n)},this.doSignInWithEmailAndPassword=function(e,n){return t.auth.signInWithEmailAndPassword(e,n)},this.doSignInWithGoogle=function(){return t.auth.signInWithPopup(t.googleProvider)},this.doSignInWithFacebook=function(){return t.auth.signInWithPopup(t.facebookProvider)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doSendEmailVerification=function(){return t.auth.currentUser.sendEmailVerification({url:"http://localhost:3000"})},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},this.onAuthUserListener=function(e,n){return t.auth.onAuthStateChanged(function(a){a?t.user(a.uid).once("value").then(function(t){var n=t.val();n.roles||(n.roles=[]),a=Object(C.a)({uid:a.uid,email:a.email,emailVerified:a.emailVerified,providerData:a.providerData},n),e(a)}):n()})},this.user=function(e){return t.db.ref("users/".concat(e))},this.users=function(){return t.db.ref("users")},this.mem=function(e){return t.db.ref("memes/".concat(e))},this.memes=function(){return t.db.ref("memes")},this.comment=function(e,n){return t.db.ref("memes/".concat(e,"/comments/").concat(n))},this.likes=function(e){return t.db.ref("memes/".concat(e))},this.dislike=function(e,n){return t.db.ref("memes/".concat(e,"/likes/").concat(n))},k.a.initializeApp(y),this.serverValue=k.a.database.ServerValue,this.emailAuthProvider=k.a.auth.EmailAuthProvider,this.auth=k.a.auth(),this.db=k.a.database(),this.googleProvider=new k.a.auth.GoogleAuthProvider,this.facebookProvider=new k.a.auth.FacebookAuthProvider},M=function(e){var t=function(t){function n(e){var t;return Object(c.a)(this,n),(t=Object(m.a)(this,Object(d.a)(n).call(this,e))).state={authUser:JSON.parse(localStorage.getItem("authUser"))},t}return Object(h.a)(n,t),Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.listener=this.props.firebase.onAuthUserListener(function(t){localStorage.setItem("authUser",JSON.stringify(t)),e.setState({authUser:t})},function(){localStorage.removeItem("authUser"),e.setState({authUser:null})})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return r.a.createElement(g.Provider,{value:this.state.authUser},r.a.createElement(e,this.props))}}]),n}(r.a.Component);return S(t)},U=n(185),A=n(19),T="/",L=function(e){return function(t){var n=function(n){function a(){return Object(c.a)(this,a),Object(m.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(h.a)(a,n),Object(u.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.onAuthUserListener(function(n){e(n)||t.props.history.push("/signin")},function(){return t.props.history.push("/signin")})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){var n=this;return r.a.createElement(g.Consumer,null,function(a){return e(a)?r.a.createElement(t,n.props):null})}}]),a}(r.a.Component);return Object(A.a)(U.a,S)(n)}},D=function(e){var t=function(t){function n(e){var t;return Object(c.a)(this,n),(t=Object(m.a)(this,Object(d.a)(n).call(this,e))).onSendEmailVerification=function(){t.props.firebase.doSendEmailVerification().then(function(){return t.setState({isSent:!0})})},t.state={isSent:!1},t}return Object(h.a)(n,t),Object(u.a)(n,[{key:"render",value:function(){var t=this;return r.a.createElement(g.Consumer,null,function(n){return function(e){return e&&!e.emailVerified&&e.providerData.map(function(e){return e.providerId}).includes("password")}(n)?r.a.createElement("div",null,t.state.isSent?r.a.createElement("p",null,"E-Mail confirmation sent: Check you E-Mails (Spam folder included) for a confirmation E-Mail. Refresh this page once you confirmed your E-Mail."):r.a.createElement("p",null,"Verify your E-Mail: Check you E-Mails (Spam folder included) for a confirmation E-Mail or send another confirmation E-Mail."),r.a.createElement("button",{type:"button",onClick:t.onSendEmailVerification,disabled:t.state.isSent},"Send confirmation E-Mail")):r.a.createElement(e,t.props)})}}]),n}(r.a.Component);return S(t)},I=S(function(e){var t=e.firebase;return r.a.createElement("button",{type:"button",onClick:t.doSignOut},"Sign Out")}),N="ADMIN",P=function(){return r.a.createElement("div",null,r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement(p.a,{to:"/account"},"Your profile")),r.a.createElement(I,null)))},x=function(){return r.a.createElement("div",null,r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement(p.a,{to:"/signup"},"Sign up")),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/signin"},"Sign in"))))},R=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".sidenav");b.a.Sidenav.init(e,{edge:"right"});var t=document.querySelector(".collapsible");b.a.Collapsible.init(t,{inDuration:380})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("ul",{id:"mobile-demo",className:"sidenav"},r.a.createElement("li",null,r.a.createElement("ul",{className:"collapsible"},r.a.createElement("li",null,r.a.createElement("div",{className:"collapsible-header black-text"},r.a.createElement("i",{className:"material-icons collapsible-secondary"},"arrow_drop_down"),r.a.createElement("b",null,"Categories")),r.a.createElement("div",{className:"collapsible-body black-text"},r.a.createElement("a",{href:"#",className:"black-text sidenav-close"},r.a.createElement("span",{style:{marginLeft:16}},"Category")),r.a.createElement("a",{href:"#",className:"black-text sidenav-close"},r.a.createElement("span",{style:{marginLeft:16}},"Category")),r.a.createElement("a",{href:"#",className:"black-text sidenav-close"},r.a.createElement("span",{style:{marginLeft:16}},"Category")),r.a.createElement("a",{href:"#",className:"black-text sidenav-close"},r.a.createElement("span",{style:{marginLeft:16}},"Category")),r.a.createElement("a",{href:"#",className:"black-text sidenav-close"},r.a.createElement("span",{style:{marginLeft:16}},"Category")))))),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/randomMem",className:"sidenav-close"},"Random meme")),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/signup",className:"sidenav-close"},"Sign up")),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/signin",className:"sidenav-close"},"Sign in")),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/account",className:"sidenav-close"},"Your profile")),r.a.createElement("li",null,r.a.createElement(p.a,{to:"/account",className:"red-text sidenav-close"},"Sign out"))),r.a.createElement("a",{href:"#","data-target":"mobile-demo",className:"sidenav-trigger right"},r.a.createElement("i",{className:"material-icons"},"menu")))}}]),t}(a.Component),V=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelector(".dropdown-trigger");b.a.Dropdown.init(e,{coverTrigger:!1,constrainWidth:!1,inDuration:380,outDuration:380})}},{key:"render",value:function(){return r.a.createElement("div",{className:"navbar-fixed",style:{zIndex:999}},r.a.createElement("nav",{className:"nav-extended"},r.a.createElement("div",{className:"nav-wrapper grey darken-3"},r.a.createElement(f.a,{to:"/",className:"brand-logo orange-text text-darken-2 left",style:{paddingLeft:10}},"HalfLajf"),r.a.createElement(R,null),this.props.authenticated?r.a.createElement(P,null):r.a.createElement(x,null),r.a.createElement("ul",{className:"right hide-on-med-and-down"},r.a.createElement("ul",{id:"dropdown1",className:"dropdown-content"},r.a.createElement("li",null,r.a.createElement("a",{href:"#",className:"black-text"},"Category 1")),r.a.createElement("li",{className:"divider"}),r.a.createElement("li",null,r.a.createElement("a",{href:"#",className:"black-text"},"Category 2")),r.a.createElement("li",{className:"divider"}),r.a.createElement("li",null,r.a.createElement("a",{href:"#",className:"black-text"},"Category 3"))),r.a.createElement("li",null,r.a.createElement("a",{className:"dropdown-trigger",href:"#!","data-target":"dropdown1"},"Categories",r.a.createElement("i",{className:"material-icons right"},"arrow_drop_down"))),r.a.createElement("li",null,r.a.createElement(f.a,{to:"/randomMem"},"Random meme"))))))}}]),t}(a.Component),W=function(){return r.a.createElement(g.Consumer,null,function(e){return e?r.a.createElement(V,{authenticated:!0}):r.a.createElement(V,{authenticated:!1})})},z=n(23),F=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onRemoveComment=function(e,t){n.props.firebase.comment(e,t).set([])},n.onToggleCommentEditMode=function(){n.setState(function(e){return{CommentEditMode:!e.CommentEditMode,editComment:n.props.comment.comment}})},n.onEditMessage=function(e,t,a,r){t.comment;var o=Object(z.a)(t,["comment"]);n.props.firebase.comment(e,r).set(Object(C.a)({},o,{editedAt:n.props.firebase.serverValue.TIMESTAMP,comment:a})),n.setState({CommentEditMode:!1})},n.onChangeeditComment=function(e){n.setState({editComment:e.target.value})},n.state={CommentEditMode:!1,editComment:n.props.comment.comment},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.CommentEditMode,a=t.editComment,o=this.props,i=o.comment,l=o.index,s=o.MemUid,c=o.authUser;return r.a.createElement("div",{style:{padding:3}},n?r.a.createElement("input",{type:"text",value:a,onChange:this.onChangeeditComment}):r.a.createElement("span",null,"Created by: ",i.username||i.userId," ",r.a.createElement("br",null),i.comment,i.editedAt?r.a.createElement("div",null,"Edited At:"," ",new Date(i.editedAt).toLocaleTimeString("en-US")," ",new Date(i.editedAt).toLocaleDateString("en-US")):r.a.createElement("div",null,"Created At:"," ",new Date(i.createdAt).toLocaleTimeString("en-US")," ",new Date(i.createdAt).toLocaleDateString("en-US"))),c?r.a.createElement("span",null,c.roles.includes(N)&&r.a.createElement("span",null,n?r.a.createElement("span",null,r.a.createElement("button",{onClick:function(){return e.onEditMessage(s,i,a,l)}},"Save"),r.a.createElement("button",{onClick:this.onToggleCommentEditMode},"Cofnij")):r.a.createElement("button",{onClick:this.onToggleCommentEditMode},"Edit"),!n&&r.a.createElement("button",{onClick:function(){return e.onRemoveComment(s,l)}},"Delete comment")),c.uid===i.userId&&!c.roles.includes(N)&&r.a.createElement("span",null,n?r.a.createElement("span",null,r.a.createElement("button",{onClick:function(){return e.onEditMessage(s,i,a,l)}},"Save"),r.a.createElement("button",{onClick:this.onToggleCommentEditMode},"Cofnij")):r.a.createElement("button",{onClick:this.onToggleCommentEditMode},"Edit"),!n&&r.a.createElement("button",{onClick:function(){return e.onRemoveComment(s,l)}},"Delete comment"))):r.a.createElement("span",null))}}]),t}(a.Component),B=S(F),J=function(e){var t=e.comments,n=e.MemUid,a=e.authUser;return r.a.createElement("ul",{className:"comment section"},t.map(function(e,t){return r.a.createElement("li",null,r.a.createElement(B,{key:t,comment:e,index:t,MemUid:n,authUser:a}))}))},_=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onToggleEditUrlMode=function(){n.setState(function(e){return{editUrlMode:!e.editUrlMode,editUrl:n.props.mem.url}})},n.onChangeEditUrl=function(e){n.setState({editUrl:e.target.value})},n.onSaveEditUrl=function(){n.props.onEditMem(n.props.mem,n.state.editUrl),n.setState({editUrlMode:!1})},n.onSaveEditComment=function(){n.props.onAddComment(n.props.mem,n.state.comment,n.props.authUser),n.setState({editUrlMode:!1,comment:""})},n.onChangeComment=function(e){n.setState({comment:e.target.value})},n.onLike=function(e,t){var a=e.likes,r=Object(z.a)(e,["likes"]),o={userId:t};a||(a=[]),a.push(o),n.props.firebase.likes(e.uid).update(Object(C.a)({},r,{likes:a}))},n.onDislike=function(e,t){if(e.likes){var a=Object.keys(e.likes).map(function(t){return Object(C.a)({},e.likes[t],{uid:t})}).filter(function(e){return e.userId===t});n.props.firebase.dislike(e.uid,a[0].uid).remove()}},n.state={editUrlMode:!1,editUrl:n.props.mem.url,comment:"",likes:[]},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.authUser,a=t.mem,o=this.state,i=o.editUrlMode,l=o.editUrl,s=o.comment;return r.a.createElement("li",{className:"card z-depth-1 meme-summary"},i?r.a.createElement("input",{type:"text",value:l,onChange:this.onChangeEditUrl}):r.a.createElement("span",{className:"card-image"},r.a.createElement("strong",null,r.a.createElement("h2",null,a.title),"Created by: ",a.username||a.userId," ",r.a.createElement("br",null),"Tags: ",a.tags," ",r.a.createElement("br",null),a.editedAt?r.a.createElement("div",null,"Edited At:"," ",new Date(a.editedAt).toLocaleTimeString("en-US")," ",new Date(a.editedAt).toLocaleDateString("en-US")):r.a.createElement("div",null,"Created At:"," ",new Date(a.createdAt).toLocaleTimeString("en-US")," ",new Date(a.createdAt).toLocaleDateString("en-US")))," ",r.a.createElement("img",{style:{padding:4},src:a.url,alt:""})),n?r.a.createElement("span",null,r.a.createElement("div",null,r.a.createElement("span",null,"Likes")," ",a.likes?r.a.createElement("span",null,r.a.createElement("span",null,a.likes.filter(function(e){return null!=e}).length),a.likes.filter(function(e){return e.userId===n.uid}).length?r.a.createElement("span",null,r.a.createElement("button",{onClick:function(){return e.onDislike(a,n.uid)}},"dislike")):r.a.createElement("button",{onClick:function(){return e.onLike(a,n.uid)}},"like")):r.a.createElement("span",null,r.a.createElement("span",null,"0"),r.a.createElement("button",{onClick:function(){return e.onLike(a,n.uid)}},"like")))):r.a.createElement("div",null,r.a.createElement("span",null,"Likes")," ",a.likes?r.a.createElement("span",null,a.likes.filter(function(e){return null!=e}).length):r.a.createElement("span",null,"0")),a.comments?r.a.createElement("div",null," ","Comments:",r.a.createElement(J,{comments:a.comments,MemUid:a.uid,authUser:n})):r.a.createElement("div",null,"There are no comments ..."),n?r.a.createElement("div",null,r.a.createElement("div",{className:"input-field"},r.a.createElement("i",{className:"material-icons prefix"},"border_color"),r.a.createElement("input",{className:"materialize-textarea",id:"userComment",type:"text",value:s,onChange:this.onChangeComment}),r.a.createElement("label",{htmlFor:"userComment"},"Share your thoughts about this meme")),r.a.createElement("span",{className:"input-field",style:{padding:2}},r.a.createElement("button",{onClick:this.onSaveEditComment,className:"btn orange darken-2 z-depth-1"},"Add comment"))):r.a.createElement("span",null))}}]),t}(a.Component),G=S(_),q=function(e){var t=e.memes,n=e.authUser,a=e.onAddComment;return r.a.createElement("ul",null,t.map(function(e){return r.a.createElement(G,{key:e.uid,mem:e,authUser:n,onAddComment:a})}))},Q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onAddComment=function(e,t,a){e.uid;var r=Object(z.a)(e,["uid"]),o=e.comments;a.username||(a.username="Annymous");var i={userId:a.uid,username:a.username,createdAt:n.props.firebase.serverValue.TIMESTAMP,comment:t};o||(o=[]),o.push(i),n.props.firebase.mem(e.uid).set(Object(C.a)({},r,{comments:o}))},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.memes;return r.a.createElement(g.Consumer,null,function(n){return r.a.createElement("div",null,t?r.a.createElement(q,{authUser:n,memes:t,onAddComment:e.onAddComment}):r.a.createElement("div",null))})}}]),t}(a.Component),Y=S(Q),H=Y,K=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSearchValue=function(e){n.onListenForMemes(),n.setState({searchValue:e.target.value},function(){return n.getMemesByTag()})},n.getMemesByTag=function(){n.setState({memes:n.state.memes.filter(function(e){return e.tags.includes(n.state.searchValue)})})},n.getAllMemes=function(){n.onListenForMemes()},n.state={memes:[],searchValue:"",loading:!1},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.onListenForMemes()}},{key:"onListenForMemes",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.memes().on("value",function(t){var n=t.val();if(n){var a=Object.keys(n).map(function(e){return Object(C.a)({},n[e],{uid:e})});e.setState({memes:a,loading:!1})}else e.setState({memes:null,loading:!1});e.setState({loading:!1})})}},{key:"componentWillUnmount",value:function(){this.props.firebase.memes().off()}},{key:"render",value:function(){var e=this.state,t=e.memes,n=e.loading;return r.a.createElement("div",{className:"row col s12 m8 offset-m2"},r.a.createElement("span",null,r.a.createElement("button",{onClick:this.onSearchValue,value:"#janusz"},"#janusz"),r.a.createElement("button",{onClick:this.onSearchValue,value:"#zwierze"},"#zwierze"),r.a.createElement("button",{onClick:this.onSearchValue,value:"#maciek"},"#maciek"),r.a.createElement("button",{onClick:this.getAllMemes},"wszystkie")),n?r.a.createElement("div",null,"Loading..."):r.a.createElement("span",null,t.length?r.a.createElement(Y,{memes:t,loading:n}):r.a.createElement("div",null,"There are no memes ...")))}}]),t}(a.Component),Z=S(K),$=function(){return r.a.createElement("div",{className:"dashboard container"},r.a.createElement("span",null,r.a.createElement(Z,null),r.a.createElement(H,null)))},X=n(13),ee={username:"",email:"",passwordOne:"",passwordTwo:"",isAdmin:!1,error:null},te="auth/email-already-in-use",ne="\n  An account with this E-Mail address already exists.\n  Try to login with this account instead. If you think the\n  account is already used from one of the social logins, try\n  to sign in with one of them. Afterward, associate your accounts\n  on your personal account page.\n",ae=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){var t=n.state,a=t.username,r=t.email,o=t.passwordOne,i=t.isAdmin,l=[];i&&l.push(N),n.props.firebase.doCreateUserWithEmailAndPassword(r,o).then(function(e){return n.props.firebase.user(e.user.uid).set({username:a,email:r,roles:l})}).then(function(){return n.props.firebase.doSendEmailVerification()}).then(function(){n.setState(Object(C.a)({},ee)),n.props.history.push(T)}).catch(function(e){e.code===te&&(e.message=ne),n.setState({error:e})}),e.preventDefault()},n.onChange=function(e){n.setState(Object(X.a)({},e.target.name,e.target.value))},n.onChangeCheckbox=function(e){n.setState(Object(X.a)({},e.target.name,e.target.checked))},n.state=Object(C.a)({},ee),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,n=e.email,a=e.passwordOne,o=e.passwordTwo,i=e.isAdmin,l=e.error,s=a!==o||""===a||""===n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"}),r.a.createElement("input",{name:"email",value:n,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("input",{name:"passwordOne",value:a,onChange:this.onChange,type:"password",placeholder:"Password"}),r.a.createElement("input",{name:"passwordTwo",value:o,onChange:this.onChange,type:"password",placeholder:"Confirm Password"}),r.a.createElement("label",null,"Admin:",r.a.createElement("input",{name:"isAdmin",type:"checkbox",checked:i,onChange:this.onChangeCheckbox})),r.a.createElement("button",{disabled:s,type:"submit"},"Sign Up"),l&&r.a.createElement("p",null,l.message))}}]),t}(a.Component),re=function(){return r.a.createElement("p",null,"Don't have an account? ",r.a.createElement(f.a,{to:"/signup"},"Sign Up"))},oe=Object(U.a)(S(ae)),ie=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SignUp"),r.a.createElement(oe,null))},le={email:"",error:null},se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){var t=n.state.email;n.props.firebase.doPasswordReset(t).then(function(){n.setState(Object(C.a)({},le))}).catch(function(e){n.setState({error:e})}),e.preventDefault()},n.onChange=function(e){n.setState(Object(X.a)({},e.target.name,e.target.value))},n.state=Object(C.a)({},le),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.error,a=""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"email",value:this.state.email,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("button",{disabled:a,type:"submit"},"Reset My Password"),n&&r.a.createElement("p",null,n.message))}}]),t}(a.Component),ce=function(){return r.a.createElement("p",null,r.a.createElement(f.a,{to:"/pw-forget"},"Forgot Password?"))},ue=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"PasswordForget"),r.a.createElement(me,null))},me=S(se),de={email:"",password:"",error:null},he="auth/account-exists-with-different-credential",pe="\n  An account with an E-Mail address to\n  this social account already exists. Try to login from\n  this account instead and associate your social accounts on\n  your personal account page.\n",fe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){var t=n.state,a=t.email,r=t.password;n.props.firebase.doSignInWithEmailAndPassword(a,r).then(function(){n.setState(Object(C.a)({},de)),n.props.history.push(T)}).catch(function(e){n.setState({error:e})}),e.preventDefault()},n.onChange=function(e){n.setState(Object(X.a)({},e.target.name,e.target.value))},n.state=Object(C.a)({},de),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.error,o=""===n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"email",value:t,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("input",{name:"password",value:n,onChange:this.onChange,type:"password",placeholder:"Password"}),r.a.createElement("button",{disabled:o,type:"submit"},"Sign In"),a&&r.a.createElement("p",null,a.message))}}]),t}(a.Component),Ee=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){n.props.firebase.doSignInWithGoogle().then(function(e){return n.props.firebase.user(e.user.uid).set({username:e.user.displayName,email:e.user.email,roles:[]})}).then(function(){n.setState({error:null}),n.props.history.push(T)}).catch(function(e){e.code===he&&(e.message=pe),n.setState({error:e})}),e.preventDefault()},n.state={error:null},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.error;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("button",{type:"submit"},"Sign In with Google"),e&&r.a.createElement("p",null,e.message))}}]),t}(a.Component),be=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){n.props.firebase.doSignInWithFacebook().then(function(e){return console.log(e),n.props.firebase.user(e.user.uid).set({username:e.additionalUserInfo.profile.name,roles:[]})}).then(function(){n.setState({error:null}),n.props.history.push(T)}).catch(function(e){e.code===he&&(e.message=pe),n.setState({error:e})}),e.preventDefault()},n.state={error:null},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.error;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("button",{type:"submit"},"Sign In with Facebook"),console.log(e),e&&r.a.createElement("p",null,e.message))}}]),t}(a.Component),ge=Object(A.a)(U.a,S)(fe),ve=Object(A.a)(U.a,S)(Ee),Se=Object(A.a)(U.a,S)(be),Oe=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SignIn"),r.a.createElement(ge,null),r.a.createElement(ve,null),r.a.createElement(Se,null),r.a.createElement(ce,null),r.a.createElement(re,null))},Ce={passwordOne:"",passwordTwo:"",error:null},je=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){var t=n.state.passwordOne;n.props.firebase.doPasswordUpdate(t).then(function(){n.setState(Object(C.a)({},Ce))}).catch(function(e){n.setState({error:e})}),e.preventDefault()},n.onChange=function(e){n.setState(Object(X.a)({},e.target.name,e.target.value))},n.state=Object(C.a)({},Ce),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state,t=e.passwordOne,n=e.passwordTwo,a=e.error,o=t!==n||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"passwordOne",value:t,onChange:this.onChange,type:"password",placeholder:"New Password"}),r.a.createElement("input",{name:"passwordTwo",value:n,onChange:this.onChange,type:"password",placeholder:"Confirm New Password"}),r.a.createElement("button",{disabled:o,type:"submit"},"Reset My Password"),a&&r.a.createElement("p",null,a.message))}}]),t}(a.Component),ke=S(je),ye=[{id:"password",provider:null},{id:"google.com",provider:"googleProvider"},{id:"facebook.com",provider:"facebookProvider"}],we=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).fetchSignInMethods=function(){n.props.firebase.auth.fetchSignInMethodsForEmail(n.props.authUser.email).then(function(e){return n.setState({activeSignInMethods:e,error:null})}).catch(function(e){return n.setState({error:e})})},n.onSocialLoginLink=function(e){n.props.firebase.auth.currentUser.linkWithPopup(n.props.firebase[e]).then(n.fetchSignInMethods).catch(function(e){return n.setState({error:e})})},n.onDefaultLoginLink=function(e){var t=n.props.firebase.emailAuthProvider.credential(n.props.authUser.email,e);n.props.firebase.auth.currentUser.linkAndRetrieveDataWithCredential(t).then(n.fetchSignInMethods).catch(function(e){return n.setState({error:e})})},n.onUnlink=function(e){n.props.firebase.auth.currentUser.unlink(e).then(n.fetchSignInMethods).catch(function(e){return n.setState({error:e})})},n.state={activeSignInMethods:[],error:null},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.fetchSignInMethods()}},{key:"render",value:function(){var e=this,t=this.state,n=t.activeSignInMethods,a=t.error;return r.a.createElement("div",null,"Sign In Methods:",r.a.createElement("ul",null,ye.map(function(t){var a=1===n.length,o=n.includes(t.id);return r.a.createElement("li",{key:t.id},"password"===t.id?r.a.createElement(Ue,{onlyOneLeft:a,isEnabled:o,signInMethod:t,onLink:e.onDefaultLoginLink,onUnlink:e.onUnlink}):r.a.createElement(Me,{onlyOneLeft:a,isEnabled:o,signInMethod:t,onLink:e.onSocialLoginLink,onUnlink:e.onUnlink}))})),a&&a.message)}}]),t}(a.Component),Me=function(e){var t=e.onlyOneLeft,n=e.isEnabled,a=e.signInMethod,o=e.onLink,i=e.onUnlink;return n?r.a.createElement("button",{type:"button",onClick:function(){return i(a.id)},disabled:t},"Deactivate ",a.id):r.a.createElement("button",{type:"button",onClick:function(){return o(a.provider)}},"Link ",a.id)},Ue=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault(),n.props.onLink(n.state.passwordOne),n.setState({passwordOne:"",passwordTwo:""})},n.onChange=function(e){n.setState(Object(X.a)({},e.target.name,e.target.value))},n.state={passwordOne:"",passwordTwo:""},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onlyOneLeft,n=e.isEnabled,a=e.signInMethod,o=e.onUnlink,i=this.state,l=i.passwordOne,s=i.passwordTwo,c=l!==s||""===l;return n?r.a.createElement("button",{type:"button",onClick:function(){return o(a.id)},disabled:t},"Deactivate ",a.id):r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"passwordOne",value:l,onChange:this.onChange,type:"password",placeholder:"New Password"}),r.a.createElement("input",{name:"passwordTwo",value:s,onChange:this.onChange,type:"password",placeholder:"Confirm New Password"}),r.a.createElement("button",{disabled:c,type:"submit"},"Link ",a.id))}}]),t}(a.Component),Ae=S(we),Te=Object(A.a)(D,L(function(e){return!!e}))(function(){return r.a.createElement(g.Consumer,null,function(e){return r.a.createElement("div",null,r.a.createElement("h1",null,"Account: ",e.email),r.a.createElement(me,null),r.a.createElement(ke,null),r.a.createElement(Ae,{authUser:e}))})}),Le=n(184),De=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={loading:!1,users:[]},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.users().on("value",function(t){var n=t.val(),a=Object.keys(n).map(function(e){return Object(C.a)({},n[e],{uid:e})});e.setState({users:a,loading:!1})})}},{key:"componentWillUnmount",value:function(){this.props.firebase.users().off()}},{key:"render",value:function(){var e=this.state,t=e.users,n=e.loading;return r.a.createElement("div",null," ",r.a.createElement("div",null,r.a.createElement(f.a,{to:{pathname:"".concat("/admin/manageMemes")}},"Manage memes")),r.a.createElement("h2",null,"Users"),n&&r.a.createElement("div",null,"Loading ..."),r.a.createElement("ul",null,t.map(function(e){return r.a.createElement("li",{key:e.uid},r.a.createElement("span",null,r.a.createElement("strong",null,"ID:")," ",e.uid),r.a.createElement("span",null,r.a.createElement("strong",null,"E-Mail:")," ",e.email),r.a.createElement("span",null,r.a.createElement("strong",null,"Username:")," ",e.username)," ",r.a.createElement("span",null,r.a.createElement(f.a,{to:{pathname:"".concat("/admin","/").concat(e.uid),state:{user:e}}},"Details")))})))}}]),t}(a.Component),Ie=S(De),Ne=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onSendPasswordResetEmail=function(){n.props.firebase.doPasswordReset(n.state.user.email)},n.state=Object(C.a)({loading:!1,user:null},e.location.state),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.user||(this.setState({loading:!0}),this.props.firebase.user(this.props.match.params.id).on("value",function(t){e.setState({user:t.val(),loading:!1})}))}},{key:"componentWillUnmount",value:function(){this.props.firebase.user(this.props.match.params.id).off()}},{key:"render",value:function(){var e=this.state,t=e.user,n=e.loading;return r.a.createElement("div",null,r.a.createElement("h2",null,"User (",this.props.match.params.id,")"),n&&r.a.createElement("div",null,"Loading ..."),t&&r.a.createElement("div",null,r.a.createElement("span",null,r.a.createElement("strong",null,"ID:")," ",t.uid),r.a.createElement("span",null,r.a.createElement("strong",null,"E-Mail:")," ",t.email),r.a.createElement("span",null,r.a.createElement("strong",null,"Username:")," ",t.username),r.a.createElement("span",null,r.a.createElement("button",{type:"button",onClick:this.onSendPasswordResetEmail},"Send Password Reset"))))}}]),t}(a.Component),Pe=S(Ne),xe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onChangeUrl=function(e){n.setState({url:e.target.value})},n.onChangeTitle=function(e){n.setState({title:e.target.value})},n.onChangeTags=function(e){n.setState({tags:e.target.value})},n.onSerializeTags=function(){return n.state.tags.split(" ")},n.onCreateMem=function(e,t){n.props.firebase.memes().push({url:n.state.url,userId:t.uid,username:t.username,createdAt:n.props.firebase.serverValue.TIMESTAMP,title:n.state.title,tags:n.onSerializeTags(),comments:[]}),n.setState({url:"",title:"",tags:""}),e.preventDefault()},n.state={url:"",title:"",tags:""},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.url,a=t.title,o=t.tags;return r.a.createElement(g.Consumer,null,function(t){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(n){return e.onCreateMem(n,t)}},"img src",r.a.createElement("input",{type:"text",value:n,onChange:e.onChangeUrl}),"title",r.a.createElement("input",{type:"text",value:a,onChange:e.onChangeTitle}),"tags",r.a.createElement("input",{type:"text",value:o,onChange:e.onChangeTags}),r.a.createElement("button",{type:"submit"},"Send")))})}}]),t}(a.Component),Re=S(xe),Ve=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onEditMem=function(e,t,a,r){e.uid;var o=Object(z.a)(e,["uid"]);n.props.firebase.mem(e.uid).set(Object(C.a)({},o,{url:t,title:a,tags:r,editedAt:n.props.firebase.serverValue.TIMESTAMP}))},n.onRemoveMem=function(e){n.props.firebase.mem(e).remove()},n.state={loading:!1,memes:[]},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.onListenForMemes()}},{key:"onListenForMemes",value:function(){var e=this;this.setState({loading:!0}),this.props.firebase.memes().on("value",function(t){var n=t.val();if(n){var a=Object.keys(n).map(function(e){return Object(C.a)({},n[e],{uid:e})});e.setState({loading:!1,memes:a})}else e.setState({memes:null,loading:!1});e.setState({loading:!1})})}},{key:"componentWillUnmount",value:function(){this.props.firebase.memes().off()}},{key:"render",value:function(){var e=this,t=this.state,n=t.memes;t.loading;return r.a.createElement(g.Consumer,null,function(t){return r.a.createElement("div",null,r.a.createElement(Re,null),n?r.a.createElement(We,{authUser:t,memes:n,onRemoveMem:e.onRemoveMem,onEditMem:e.onEditMem}):r.a.createElement("div",null,"There are no memes ..."))})}}]),t}(a.Component),We=function(e){var t=e.memes,n=e.onRemoveMem,a=e.onEditMem,o=e.authUser;return r.a.createElement("ul",null,t.map(function(e){return r.a.createElement(ze,{key:e.uid,mem:e,onRemoveMem:n,onEditMem:a,authUser:o})}))},ze=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).onToggleEditUrlMode=function(){n.setState(function(e){return{editUrlMode:!e.editUrlMode,editUrl:n.props.mem.url,editTitle:n.props.mem.title}})},n.onChangeEditUrl=function(e){n.setState({editUrl:e.target.value})},n.onChangeEditTitle=function(e){n.setState({editTitle:e.target.value})},n.onChangeEditTags=function(e){n.setState({editTags:e.target.value})},n.onSaveEditUrl=function(){n.props.onEditMem(n.props.mem,n.state.editUrl,n.state.editTitle,n.state.editTags.split(" ")),n.setState({editUrlMode:!1})},n.state={editUrlMode:!1,editUrl:n.props.mem.url,editTitle:n.props.mem.title,editTags:n.props.mem.tags.join(" ")},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.mem,n=e.onRemoveMem,a=this.state,o=a.editUrlMode,i=a.editUrl,l=a.editTitle,s=a.editTags;return r.a.createElement("li",null,o?r.a.createElement("span",null,r.a.createElement("input",{type:"text",value:l,onChange:this.onChangeEditTitle})," ",r.a.createElement("br",null)," ",r.a.createElement("input",{type:"text",value:i,onChange:this.onChangeEditUrl}),r.a.createElement("br",null)," ",r.a.createElement("input",{type:"text",value:s,onChange:this.onChangeEditTags})):r.a.createElement("span",null,r.a.createElement("img",{src:t.url,alt:""})),o?r.a.createElement("div",null,r.a.createElement("button",{onClick:this.onSaveEditUrl},"Save"),r.a.createElement("button",{onClick:this.onToggleEditUrlMode},"Return")):r.a.createElement("span",null,r.a.createElement("div",null,"Title ",t.title),r.a.createElement("div",null,"URL ",t.url),r.a.createElement("div",null,"Tags ",t.tags),r.a.createElement("button",{onClick:this.onToggleEditUrlMode},"Edit")),!o&&r.a.createElement("button",{type:"button",onClick:function(){return n(t.uid)}},"Delete"),r.a.createElement("div",null))}}]),t}(a.Component);S(ze);var Fe=S(Ve),Be=Object(A.a)(D,L(function(e){return e&&e.roles.includes(N)}))(function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Admin Page"),r.a.createElement("p",null,"The Admin Page is accessible by every signed in admin user."),r.a.createElement(Le.a,null,r.a.createElement(s.a,{exact:!0,path:"/admin/manageMemes",component:Fe}),r.a.createElement(s.a,{exact:!0,path:"/admin/:id",component:Pe}),r.a.createElement(s.a,{exact:!0,path:"/admin",component:Ie})))}),Je="https://some-random-api.ml/meme",_e=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).getRandomMem=function(){n.setState({isLoading:!0}),fetch(Je).then(function(e){if(e.ok)return e.json();throw new Error("Something went wrong ...")}).then(function(e){return n.setState({mem:e,isLoading:!1})}).catch(function(e){return n.setState({error:e,isLoading:!1})})},n.state={mem:{},isLoading:!1,error:null},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getRandomMem()}},{key:"render",value:function(){var e=this.state,t=e.mem,n=e.isLoading,a=e.error;return a?r.a.createElement("p",null,a.message):n?r.a.createElement("p",null,"Loading ..."):r.a.createElement("span",null,r.a.createElement("img",{src:t.image,alt:t.caption}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.getRandomMem},"Roll next!"))}}]),t}(a.Component),Ge=M(function(){return r.a.createElement(l.a,null,r.a.createElement("div",null,r.a.createElement(W,null),r.a.createElement(s.a,{exact:!0,path:T,component:$}),r.a.createElement(s.a,{path:"/randomMem",component:_e}),r.a.createElement(s.a,{path:"/signup",component:ie}),r.a.createElement(s.a,{path:"/signin",component:Oe}),r.a.createElement(s.a,{path:"/pw-forget",component:ue}),r.a.createElement(s.a,{path:"/account",component:Te}),r.a.createElement(s.a,{path:"/admin",component:Be})))});i.a.render(r.a.createElement(O.Provider,{value:new w},r.a.createElement(Ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},88:function(e,t,n){e.exports=n(181)},93:function(e,t,n){}},[[88,2,1]]]);
//# sourceMappingURL=main.0c1665b3.chunk.js.map